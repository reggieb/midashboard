<h1>Listing widgets</h1>

<%= 
  content_tag(
    'p',
    link_to('New Widget', new_widget_path)
  ) if Widget.new.indulge?(current_user, :create)
%>

<table class="table">
  <tr>
    <th>Name</th>
    <th>Title</th>
    <th>Chart</th>
    <th>Actions</th>
  </tr>

<% @widgets.each do |widget| %>
  <tr>
    <td><%= widget.name %></td>
    <td><%= widget.title %></td>
    <td><%= widget.chart_type %>
    <td>
      <%= link_to 'Show', widget %>
      <%= link_to(
            'Edit', edit_widget_path(widget)
          ) if widget.indulge?(current_user, :update) %>
      <%= link_to(
            'Destroy', 
            widget, 
            method: :delete, 
            data: { confirm: 'Are you sure?' } 
          ) if widget.indulge?(current_user, :delete)
      %>
    </td>
  </tr>
<% end %>
</table>

